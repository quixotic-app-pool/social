'use strict';

/**
 * @Author: MichaelChen <mymac>
 * @Date:   2018-01-30T10:02:42+08:00
 * @Email:  teacherincafe@163.com
 * @Project: one_server
 * @Filename: util.js
 * @Last modified by:   mymac
 * @Last modified time: 2018-01-30T10:31:41+08:00
 */

function calLevel(p) {
  //points -> level mechanism
  if (p <= 2) {
    return 1;
  } else if (p <= 10) {
    return 2;
  } else if (p <= 20) {
    return 3;
  } else if (p <= 40) {
    return 4;
  } else if (p <= 80) {
    return 5;
  } else if (p <= 160) {
    return 6;
  } else if (p <= 320) {
    return 7;
  } else if (p <= 640) {
    return 8;
  } else if (p <= 1280) {
    return 9;
  } else {
    return 1;
  }
}

function calcTime(t, l) {
  var lang = l == 'EN';
  var str = '';
  if (t) {
    var createdAt = new Date(t);
    var now = new Date();
    var s = now - createdAt;
    if (s < 86400000 * 7) {
      var day = Math.floor(s / 86400000);
      var hour = Math.floor(s % 86400000 / 3600000);
      var minute = Math.floor(s % 86400000 % 3600000 / 60000);
      var seconds = Math.floor(s % 86400000 % 3600000 % 60000) / 1000;
      if (day > 0) {
        if (lang) {
          if (day > 1) {
            str = day + ' days ago';
          } else {
            str = day + ' day ago';
          }
        } else {
          str = day + "天前";
        }
        return str;
      }
      if (hour > 0) {
        if (lang) {
          if (hour > 1) {
            str = hour + ' hours ago';
          } else {
            str = hour + ' hour ago';
          }
        } else {
          str = hour + "小时前";
        }
        return str;
      }
      if (minute > 0) {
        if (lang) {
          if (minute > 1) {
            str = minute + ' minutes ago';
          } else {
            str = minute + ' minute ago';
          }
        } else {
          str = minute + "分钟前";
        }
        return str;
      }
      if (seconds < 60) {
        if (lang) {
          str = "just now";
        } else {
          str = "刚刚";
        }

        return str;
      }
    } else {
      return t.substring(0, 16);
    }
  } else {
    return str;
  }
}
module.exports = {
  calLevel: calLevel,
  calcTime: calcTime
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWwuanMiXSwibmFtZXMiOlsiY2FsTGV2ZWwiLCJwIiwiY2FsY1RpbWUiLCJ0IiwibCIsImxhbmciLCJzdHIiLCJjcmVhdGVkQXQiLCJEYXRlIiwibm93IiwicyIsImRheSIsIk1hdGgiLCJmbG9vciIsImhvdXIiLCJtaW51dGUiLCJzZWNvbmRzIiwic3Vic3RyaW5nIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7Ozs7OztBQVVDLFNBQVNBLFFBQVQsQ0FBa0JDLENBQWxCLEVBQXFCO0FBQ25CO0FBQ0EsTUFBR0EsS0FBSyxDQUFSLEVBQVc7QUFDVCxXQUFPLENBQVA7QUFDRCxHQUZELE1BRU8sSUFBR0EsS0FBSyxFQUFSLEVBQVk7QUFDakIsV0FBTyxDQUFQO0FBQ0QsR0FGTSxNQUVBLElBQUdBLEtBQUssRUFBUixFQUFZO0FBQ2pCLFdBQU8sQ0FBUDtBQUNELEdBRk0sTUFFQSxJQUFHQSxLQUFLLEVBQVIsRUFBWTtBQUNqQixXQUFPLENBQVA7QUFDRCxHQUZNLE1BRUEsSUFBR0EsS0FBSyxFQUFSLEVBQVk7QUFDakIsV0FBTyxDQUFQO0FBQ0QsR0FGTSxNQUVBLElBQUdBLEtBQUssR0FBUixFQUFhO0FBQ2xCLFdBQU8sQ0FBUDtBQUNELEdBRk0sTUFFQSxJQUFHQSxLQUFLLEdBQVIsRUFBYTtBQUNsQixXQUFPLENBQVA7QUFDRCxHQUZNLE1BRUEsSUFBR0EsS0FBSyxHQUFSLEVBQWE7QUFDbEIsV0FBTyxDQUFQO0FBQ0QsR0FGTSxNQUVBLElBQUdBLEtBQUssSUFBUixFQUFjO0FBQ25CLFdBQU8sQ0FBUDtBQUNELEdBRk0sTUFFQTtBQUNMLFdBQU8sQ0FBUDtBQUNEO0FBQ0Y7O0FBRUQsU0FBU0MsUUFBVCxDQUFrQkMsQ0FBbEIsRUFBcUJDLENBQXJCLEVBQXdCO0FBQ3RCLE1BQUlDLE9BQU9ELEtBQUssSUFBaEI7QUFDQSxNQUFJRSxNQUFNLEVBQVY7QUFDQSxNQUFJSCxDQUFKLEVBQU87QUFDTCxRQUFJSSxZQUFZLElBQUlDLElBQUosQ0FBU0wsQ0FBVCxDQUFoQjtBQUNBLFFBQUlNLE1BQU0sSUFBSUQsSUFBSixFQUFWO0FBQ0EsUUFBSUUsSUFBSUQsTUFBTUYsU0FBZDtBQUNBLFFBQUlHLElBQUssV0FBVyxDQUFwQixFQUF3QjtBQUN0QixVQUFJQyxNQUFNQyxLQUFLQyxLQUFMLENBQVdILElBQUksUUFBZixDQUFWO0FBQ0EsVUFBSUksT0FBT0YsS0FBS0MsS0FBTCxDQUFZSCxJQUFJLFFBQUwsR0FBaUIsT0FBNUIsQ0FBWDtBQUNBLFVBQUlLLFNBQVNILEtBQUtDLEtBQUwsQ0FBWUgsSUFBSSxRQUFKLEdBQWUsT0FBaEIsR0FBMkIsS0FBdEMsQ0FBYjtBQUNBLFVBQUlNLFVBQVVKLEtBQUtDLEtBQUwsQ0FBV0gsSUFBSSxRQUFKLEdBQWUsT0FBZixHQUF5QixLQUFwQyxJQUE2QyxJQUEzRDtBQUNBLFVBQUlDLE1BQU0sQ0FBVixFQUFhO0FBQ1gsWUFBR04sSUFBSCxFQUFTO0FBQ1AsY0FBR00sTUFBTSxDQUFULEVBQVk7QUFDVkwsa0JBQU1LLE1BQU0sV0FBWjtBQUNELFdBRkQsTUFFTztBQUNMTCxrQkFBTUssTUFBTSxVQUFaO0FBQ0Q7QUFDRixTQU5ELE1BTU87QUFDSkwsZ0JBQU1LLE1BQU0sSUFBWjtBQUNGO0FBQ0MsZUFBT0wsR0FBUDtBQUNIO0FBQ0QsVUFBSVEsT0FBTyxDQUFYLEVBQWM7QUFDWixZQUFHVCxJQUFILEVBQVM7QUFDUCxjQUFHUyxPQUFPLENBQVYsRUFBYTtBQUNYUixrQkFBTVEsT0FBTyxZQUFiO0FBQ0QsV0FGRCxNQUVPO0FBQ0xSLGtCQUFNUSxPQUFPLFdBQWI7QUFDRDtBQUNGLFNBTkQsTUFNTztBQUNMUixnQkFBTVEsT0FBTyxLQUFiO0FBQ0Q7QUFDQyxlQUFPUixHQUFQO0FBQ0g7QUFDRCxVQUFJUyxTQUFTLENBQWIsRUFBZ0I7QUFDZCxZQUFHVixJQUFILEVBQVM7QUFDUCxjQUFHVSxTQUFTLENBQVosRUFBZTtBQUNiVCxrQkFBTVMsU0FBUyxjQUFmO0FBQ0QsV0FGRCxNQUVPO0FBQ0xULGtCQUFNUyxTQUFTLGFBQWY7QUFDRDtBQUNGLFNBTkQsTUFNTztBQUNKVCxnQkFBTVMsU0FBUyxLQUFmO0FBQ0Y7QUFDQyxlQUFPVCxHQUFQO0FBQ0g7QUFDRCxVQUFJVSxVQUFVLEVBQWQsRUFBa0I7QUFDaEIsWUFBR1gsSUFBSCxFQUFTO0FBQ1BDLGdCQUFNLFVBQU47QUFDRCxTQUZELE1BRU87QUFDSkEsZ0JBQU0sSUFBTjtBQUNGOztBQUVDLGVBQU9BLEdBQVA7QUFDSDtBQUNELEtBbERGLE1Ba0RRO0FBQ0YsYUFBT0gsRUFBRWMsU0FBRixDQUFZLENBQVosRUFBZSxFQUFmLENBQVA7QUFDTDtBQUNGLEdBekRELE1BeURPO0FBQ0osV0FBT1gsR0FBUDtBQUNGO0FBQ0Y7QUFDRFksT0FBT0MsT0FBUCxHQUFpQjtBQUNmbkIsWUFBVUEsUUFESztBQUVmRSxZQUFVQTtBQUZLLENBQWpCIiwiZmlsZSI6InV0aWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBBdXRob3I6IE1pY2hhZWxDaGVuIDxteW1hYz5cbiAqIEBEYXRlOiAgIDIwMTgtMDEtMzBUMTA6MDI6NDIrMDg6MDBcbiAqIEBFbWFpbDogIHRlYWNoZXJpbmNhZmVAMTYzLmNvbVxuICogQFByb2plY3Q6IG9uZV9zZXJ2ZXJcbiAqIEBGaWxlbmFtZTogdXRpbC5qc1xuICogQExhc3QgbW9kaWZpZWQgYnk6ICAgbXltYWNcbiAqIEBMYXN0IG1vZGlmaWVkIHRpbWU6IDIwMTgtMDEtMzBUMTA6MzE6NDErMDg6MDBcbiAqL1xuXG4gZnVuY3Rpb24gY2FsTGV2ZWwocCkge1xuICAgLy9wb2ludHMgLT4gbGV2ZWwgbWVjaGFuaXNtXG4gICBpZihwIDw9IDIpIHtcbiAgICAgcmV0dXJuIDFcbiAgIH0gZWxzZSBpZihwIDw9IDEwKSB7XG4gICAgIHJldHVybiAyXG4gICB9IGVsc2UgaWYocCA8PSAyMCkge1xuICAgICByZXR1cm4gM1xuICAgfSBlbHNlIGlmKHAgPD0gNDApIHtcbiAgICAgcmV0dXJuIDRcbiAgIH0gZWxzZSBpZihwIDw9IDgwKSB7XG4gICAgIHJldHVybiA1XG4gICB9IGVsc2UgaWYocCA8PSAxNjApIHtcbiAgICAgcmV0dXJuIDZcbiAgIH0gZWxzZSBpZihwIDw9IDMyMCkge1xuICAgICByZXR1cm4gN1xuICAgfSBlbHNlIGlmKHAgPD0gNjQwKSB7XG4gICAgIHJldHVybiA4XG4gICB9IGVsc2UgaWYocCA8PSAxMjgwKSB7XG4gICAgIHJldHVybiA5XG4gICB9IGVsc2Uge1xuICAgICByZXR1cm4gMVxuICAgfVxuIH1cblxuIGZ1bmN0aW9uIGNhbGNUaW1lKHQsIGwpIHtcbiAgIHZhciBsYW5nID0gbCA9PSAnRU4nXG4gICB2YXIgc3RyID0gJyc7XG4gICBpZiAodCkge1xuICAgICB2YXIgY3JlYXRlZEF0ID0gbmV3IERhdGUodClcbiAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKClcbiAgICAgdmFyIHMgPSBub3cgLSBjcmVhdGVkQXRcbiAgICAgaWYgKHMgPCAoODY0MDAwMDAgKiA3KSkge1xuICAgICAgIHZhciBkYXkgPSBNYXRoLmZsb29yKHMgLyA4NjQwMDAwMCk7XG4gICAgICAgdmFyIGhvdXIgPSBNYXRoLmZsb29yKChzICUgODY0MDAwMDApIC8gMzYwMDAwMCk7XG4gICAgICAgdmFyIG1pbnV0ZSA9IE1hdGguZmxvb3IoKHMgJSA4NjQwMDAwMCAlIDM2MDAwMDApIC8gNjAwMDApO1xuICAgICAgIHZhciBzZWNvbmRzID0gTWF0aC5mbG9vcihzICUgODY0MDAwMDAgJSAzNjAwMDAwICUgNjAwMDApIC8gMTAwMDtcbiAgICAgICBpZiAoZGF5ID4gMCkge1xuICAgICAgICAgaWYobGFuZykge1xuICAgICAgICAgICBpZihkYXkgPiAxKSB7XG4gICAgICAgICAgICAgc3RyID0gZGF5ICsgJyBkYXlzIGFnbydcbiAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICBzdHIgPSBkYXkgKyAnIGRheSBhZ28nXG4gICAgICAgICAgIH1cbiAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdHIgPSBkYXkgKyBcIuWkqeWJjVwiO1xuICAgICAgICAgfVxuICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgIH1cbiAgICAgICBpZiAoaG91ciA+IDApIHtcbiAgICAgICAgIGlmKGxhbmcpIHtcbiAgICAgICAgICAgaWYoaG91ciA+IDEpIHtcbiAgICAgICAgICAgICBzdHIgPSBob3VyICsgJyBob3VycyBhZ28nXG4gICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgc3RyID0gaG91ciArICcgaG91ciBhZ28nXG4gICAgICAgICAgIH1cbiAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgIHN0ciA9IGhvdXIgKyBcIuWwj+aXtuWJjVwiO1xuICAgICAgICAgfVxuICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgIH1cbiAgICAgICBpZiAobWludXRlID4gMCkge1xuICAgICAgICAgaWYobGFuZykge1xuICAgICAgICAgICBpZihtaW51dGUgPiAxKSB7XG4gICAgICAgICAgICAgc3RyID0gbWludXRlICsgJyBtaW51dGVzIGFnbydcbiAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICBzdHIgPSBtaW51dGUgKyAnIG1pbnV0ZSBhZ28nXG4gICAgICAgICAgIH1cbiAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdHIgPSBtaW51dGUgKyBcIuWIhumSn+WJjVwiO1xuICAgICAgICAgfVxuICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgICAgIH1cbiAgICAgICBpZiAoc2Vjb25kcyA8IDYwKSB7XG4gICAgICAgICBpZihsYW5nKSB7XG4gICAgICAgICAgIHN0ciA9IFwianVzdCBub3dcIjtcbiAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzdHIgPSBcIuWImuWImlwiO1xuICAgICAgICAgfVxuXG4gICAgICAgICAgIHJldHVybiBzdHI7XG4gICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgcmV0dXJuIHQuc3Vic3RyaW5nKDAsIDE2KTtcbiAgICAgfVxuICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzdHI7XG4gICB9XG4gfVxuIG1vZHVsZS5leHBvcnRzID0ge1xuICAgY2FsTGV2ZWw6IGNhbExldmVsLFxuICAgY2FsY1RpbWU6IGNhbGNUaW1lXG4gfVxuIl19